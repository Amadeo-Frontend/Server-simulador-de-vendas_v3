function renderProductsHTML(products, { logoUrl = "", title = "Tabela de Produtos" } = {}) {
  const rows = products.map(p => `
    <tr>
      <td>${p.id}</td>
      <td class="mono">${p.sku}</td>
      <td>${p.nome}</td>
      <td>${p.peso ?? "—"}</td>

      <td class="money vista">${fmt(p.preco_venda_A)}</td>
      <td class="money prazo">${fmt(p.preco_venda_A_prazo)}</td>

      <td class="money vista">${fmt(p.preco_venda_B)}</td>
      <td class="money prazo">${fmt(p.preco_venda_B_prazo)}</td>

      <td class="money vista">${fmt(p.preco_venda_C)}</td>
      <td class="money prazo">${fmt(p.preco_venda_C_prazo)}</td>

      <td class="money custo">${fmt(p.custo)}</td>
      <td class="money">${fmt(p.bonificacao_unitaria)}</td>
    </tr>
  `).join("");

  return `<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>${title}</title>
<style>
  :root{
    --bg:#0b1220;--card:#111a2b;--text:#e6edf3;--muted:#93a1b1;
    --emerald:#34d399;--emerald-80:#A7F3D0;--sky:#7dd3fc;--border:#23324a;
    --accent:#f5f7fb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,Segoe UI,Inter,Arial}
  .wrap{max-width:1100px;margin:24px auto;padding:16px}
  .header{display:flex;gap:12px;align-items:center;margin-bottom:16px}
  .logo{width:36px;height:36px;border-radius:999px;overflow:hidden;background:#0ea5e9}
  .title{font-weight:700;font-size:20px}
  .tablewrap{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:auto}
  table{width:100%;border-collapse:collapse;min-width:920px}
  th,td{padding:10px 12px;border-top:1px solid var(--border);text-align:left;vertical-align:middle}
  thead th{position:sticky;top:0;background:#0f172a;border-top-color:transparent}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
  .money{text-align:center;white-space:nowrap}
  .vista{color:var(--emerald)}
  .prazo{color:var(--emerald-80)}
  .custo{color:var(--sky);text-align:right}
  @media (max-width: 760px){
    /* No mobile mostramos cards pareados */
    table{display:none}
    .cards{display:grid;gap:12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
    .card .head{display:flex;justify-content:space-between;gap:8px}
    .badge{font-size:12px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px}
    .box{border:1px solid var(--border);border-radius:8px;padding:8px}
    .lbl{font-size:11px;color:var(--muted);margin-bottom:4px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="logo">${logoUrl ? `<img src="${logoUrl}" alt="logo" style="width:100%;height:100%;object-fit:cover" />` : ""}</div>
      <div class="title">${title}</div>
    </div>

    <div class="tablewrap">
      <table>
        <thead>
          <tr>
            <th>ID</th><th>SKU</th><th>Produto</th><th>Peso</th>
            <th>À vista A</th><th>Prazo A</th>
            <th>À vista B</th><th>Prazo B</th>
            <th>À vista C</th><th>Prazo C</th>
            <th style="text-align:right">Custo</th>
            <th style="text-align:right">Bonif.</th>
          </tr>
        </thead>
        <tbody>${rows}</tbody>
      </table>

      <!-- Versão mobile como cards -->
      <div class="cards">
        ${products.map(p => `
          <div class="card">
            <div class="head">
              <div>
                <div class="badge">ID ${p.id} • SKU <span class="mono">${p.sku}</span></div>
                <div style="font-weight:600">${p.nome}</div>
                <div class="badge">Peso: ${p.peso ?? "—"}</div>
              </div>
            </div>

            <div class="grid">
              <div class="box"><div class="lbl vista">À vista A</div><div>${fmt(p.preco_venda_A)}</div></div>
              <div class="box"><div class="lbl prazo">Prazo A</div><div>${fmt(p.preco_venda_A_prazo)}</div></div>

              <div class="box"><div class="lbl vista">À vista B</div><div>${fmt(p.preco_venda_B)}</div></div>
              <div class="box"><div class="lbl prazo">Prazo B</div><div>${fmt(p.preco_venda_B_prazo)}</div></div>

              <div class="box"><div class="lbl vista">À vista C</div><div>${fmt(p.preco_venda_C)}</div></div>
              <div class="box"><div class="lbl prazo">Prazo C</div><div>${fmt(p.preco_venda_C_prazo)}</div></div>

              <div class="box" style="border-color:#38bdf8"><div class="lbl">Custo</div><div>${fmt(p.custo)}</div></div>
              <div class="box"><div class="lbl">Bonif.</div><div>${fmt(p.bonificacao_unitaria)}</div></div>
            </div>
          </div>
        `).join("")}
      </div>
    </div>
  </div>
</body>
</html>`;
}

function fmt(n){
  if (typeof n !== "number") return "—";
  return n.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
}
